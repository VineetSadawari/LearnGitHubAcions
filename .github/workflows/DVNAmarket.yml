name: DVNAPOC

on:
 workflow_dispatch:

jobs: 
  build: 
    runs-on: ubuntu-18.04
    steps: 
      - uses: actions/checkout@v2
      - name: Setup Python 3.7.12
        uses: actions/setup-python@v1
        with: 
          python-version: 3.7.12
      - name: Install python deps
        run: |
          python -m pip install --upgrade pip
          pip install requests python-owasp-zap-v2.4
      - name: Get working directory
        run: echo $(PWD)
      - name: Pull DVNA Image
        run: docker pull appsecco/dvna     
      - name: Run Docker DVNA
        run: docker run --name dvna -p 5050:5050 -d appsecco/dvna:sqlite
            - name: Sleep for a bit
        uses: jakejarvis/wait-action@master
        with:
          time: '20s'
      uses: zaproxy/action-full-scan@v0.1.0
      with:
        target: "http://localhost:5050/"
